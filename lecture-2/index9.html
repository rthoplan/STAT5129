<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Parquet Data Explainer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #1e1b4b; /* bg-indigo-900/90 */
            background: linear-gradient(135deg, #1e293b 0%, #1e1b4b 100%);
            color: #e0e7ff; /* text-indigo-100 */
        }
        .font-fira {
            font-family: 'Fira Code', monospace;
        }
        .table-header-custom {
            background-color: #312e81; /* bg-indigo-800 */
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .table-header-custom:hover {
            background-color: #3730a3; /* bg-indigo-700 */
        }
        .column-block {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid #4338ca;
        }
        .column-block:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
        }
        .highlight {
            outline: 3px solid #a5b4fc; /* indigo-300 */
            box-shadow: 0 0 20px rgba(165, 180, 252, 0.4);
        }
        .data-type {
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 9999px;
            font-weight: 500;
        }
        .string-type { background-color: #22c55e; color: white; }
        .int-type { background-color: #3b82f6; color: white; }
        .float-type { background-color: #ef4444; color: white; }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">
    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold text-white tracking-tight">Interactive Parquet Data Explainer</h1>
            <p class="mt-3 text-lg text-indigo-200">Visualizing how Parquet stores data differently from JSON.</p>
        </header>

        <!-- Main Content -->
        <div class="space-y-12">
            <!-- Step 1: Tabular View -->
            <div>
                <h2 class="text-2xl font-semibold text-white mb-4"><span class="bg-indigo-500 rounded-full px-3 py-1 mr-2">1</span> How We See The Data (A Table)</h2>
                <p class="text-indigo-200 mb-4">While Parquet stores data in columns, we usually interact with it as a simple table. Click on any column header to learn more about it.</p>
                <div class="overflow-x-auto bg-slate-800/50 p-4 rounded-lg shadow-lg border border-slate-700">
                    <table class="w-full text-sm text-left">
                        <thead class="text-xs text-indigo-100 uppercase">
                            <tr>
                                <th scope="col" class="p-3 table-header-custom rounded-tl-lg" data-col="month">Month</th>
                                <th scope="col" class="p-3 table-header-custom" data-col="district">District</th>
                                <th scope="col" class="p-3 table-header-custom" data-col="tourist_arrivals">Tourist Arrivals</th>
                                <th scope="col" class="p-3 table-header-custom" data-col="average_hotel_rate_MUR">Avg. Hotel Rate (MUR)</th>
                                <th scope="col" class="p-3 table-header-custom" data-col="rainfall_mm">Rainfall (mm)</th>
                                <th scope="col" class="p-3 table-header-custom rounded-tr-lg" data-col="electricity_consumption_MWh">Electricity (MWh)</th>
                            </tr>
                        </thead>
                        <tbody id="table-body" class="bg-slate-900/70">
                            <!-- Data will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Step 2: Columnar Storage Visualization -->
            <div>
                 <h2 class="text-2xl font-semibold text-white mb-4"><span class="bg-indigo-500 rounded-full px-3 py-1 mr-2">2</span> How Parquet Actually Stores It (Columns)</h2>
                 <p class="text-indigo-200 mb-6">This is the magic of Parquet. Instead of rows, it groups all values from a single column together. This makes compression and querying super efficient. Click a column block to see the explanation.</p>
                <div id="column-container" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                    <!-- Column blocks will be generated by JS -->
                </div>
            </div>

            <!-- Step 3: Explanation Panel -->
            <div>
                <h2 class="text-2xl font-semibold text-white mb-4"><span class="bg-indigo-500 rounded-full px-3 py-1 mr-2">3</span> Explanation</h2>
                <div id="explanation-panel" class="bg-slate-800/50 p-6 rounded-lg shadow-lg border border-slate-700 min-h-[150px]">
                    <!-- Explanation will be populated by JS -->
                </div>
            </div>
        </div>
    </div>

    <script>
        const data = [
            {"month":"January","district":"Quatre Bornes","tourist_arrivals":5824,"average_hotel_rate_MUR":6918.18,"rainfall_mm":386.9,"electricity_consumption_MWh":1571},
            {"month":"February","district":"Quatre Bornes","tourist_arrivals":5899,"average_hotel_rate_MUR":4099.2,"rainfall_mm":12.2,"electricity_consumption_MWh":2733},
            {"month":"March","district":"Mahebourg","tourist_arrivals":3978,"average_hotel_rate_MUR":3790.76,"rainfall_mm":51.7,"electricity_consumption_MWh":2395},
            {"month":"April","district":"Quatre Bornes","tourist_arrivals":7180,"average_hotel_rate_MUR":6880.64,"rainfall_mm":314.6,"electricity_consumption_MWh":554},
            {"month":"May","district":"Port Louis","tourist_arrivals":1703,"average_hotel_rate_MUR":4829.41,"rainfall_mm":297.0,"electricity_consumption_MWh":550},
            {"month":"June","district":"Vacoas-Phoenix","tourist_arrivals":4605,"average_hotel_rate_MUR":7121.4,"rainfall_mm":211.1,"electricity_consumption_MWh":1859},
            {"month":"July","district":"Mahebourg","tourist_arrivals":6388,"average_hotel_rate_MUR":3082.34,"rainfall_mm":90.6,"electricity_consumption_MWh":2179},
            {"month":"August","district":"Rose Hill","tourist_arrivals":5709,"average_hotel_rate_MUR":5240.16,"rainfall_mm":378.9,"electricity_consumption_MWh":1214},
            {"month":"September","district":"Vacoas-Phoenix","tourist_arrivals":3298,"average_hotel_rate_MUR":5692.24,"rainfall_mm":51.6,"electricity_consumption_MWh":657},
            {"month":"October","district":"Rose Hill","tourist_arrivals":7066,"average_hotel_rate_MUR":7115.87,"rainfall_mm":271.9,"electricity_consumption_MWh":790},
            {"month":"November","district":"Quatre Bornes","tourist_arrivals":4093,"average_hotel_rate_MUR":2671.51,"rainfall_mm":113.1,"electricity_consumption_MWh":2865},
            {"month":"December","district":"Mahebourg","tourist_arrivals":5463,"average_hotel_rate_MUR":7111.29,"rainfall_mm":322.0,"electricity_consumption_MWh":2846}
        ];

        const schema = {
            month: { type: 'STRING', class: 'string-type', title: 'Month' },
            district: { type: 'STRING', class: 'string-type', title: 'District' },
            tourist_arrivals: { type: 'INT64', class: 'int-type', title: 'Tourist Arrivals' },
            average_hotel_rate_MUR: { type: 'DOUBLE', class: 'float-type', title: 'Avg. Hotel Rate' },
            rainfall_mm: { type: 'DOUBLE', class: 'float-type', title: 'Rainfall' },
            electricity_consumption_MWh: { type: 'INT64', class: 'int-type', title: 'Electricity' }
        };

        const explanations = {
            default: {
                title: 'Welcome to the Parquet Explainer!',
                text: 'Click on a column header in the table or a colored block below to learn about how Parquet organizes data for maximum efficiency.'
            },
            month: {
                title: 'Column: Month (STRING)',
                text: 'In a Parquet file, all month values ("January", "February", etc.) are stored together. Because they are all strings and often repetitive, they can be compressed very efficiently using techniques like Dictionary Encoding.'
            },
            district: {
                title: 'Column: District (STRING)',
                text: 'Similar to the month column, all district names are grouped. This is highly efficient for queries like "COUNT records from Quatre Bornes", as the system only needs to look at this compressed block of data.'
            },
            tourist_arrivals: {
                title: 'Column: Tourist Arrivals (INT64)',
                text: 'All tourist arrival counts, which are integers, are stored contiguously. This allows for very fast mathematical operations like calculating the SUM or AVERAGE, as the processor can work on a clean, predictable block of numbers.'
            },
            average_hotel_rate_MUR: {
                title: 'Column: Avg. Hotel Rate (DOUBLE)',
                text: 'These floating-point numbers (doubles) are all stored together. Storing numbers of the same type in one block is key to Parquet\'s high performance for analytical calculations.'
            },
            rainfall_mm: {
                title: 'Column: Rainfall (DOUBLE)',
                text: 'All rainfall measurements are grouped into a single columnar block. If you wanted to find the month with the highest rainfall, the query would only need to scan this one small, efficient block of data, ignoring everything else.'
            },
            electricity_consumption_MWh: {
                title: 'Column: Electricity (INT64)',
                text: 'This column contains integer values for electricity consumption. Storing them together allows for specialized compression algorithms for numbers, saving space and speeding up read times.'
            }
        };

        const tableBody = document.getElementById('table-body');
        const columnContainer = document.getElementById('column-container');
        const explanationPanel = document.getElementById('explanation-panel');
        let currentHighlight = null;

        // 1. Populate Table
        data.forEach((row, index) => {
            const tr = document.createElement('tr');
            tr.className = `border-b border-slate-700 ${index % 2 === 0 ? 'bg-slate-900/50' : 'bg-slate-800/50'}`;
            tr.innerHTML = `
                <td class="p-3">${row.month}</td>
                <td class="p-3">${row.district}</td>
                <td class="p-3">${row.tourist_arrivals.toLocaleString()}</td>
                <td class="p-3">${row.average_hotel_rate_MUR.toFixed(2)}</td>
                <td class="p-3">${row.rainfall_mm}</td>
                <td class="p-3">${row.electricity_consumption_MWh.toLocaleString()}</td>
            `;
            tableBody.appendChild(tr);
        });

        // 2. Populate Column Blocks
        Object.keys(schema).forEach(key => {
            const colInfo = schema[key];
            const colBlock = document.createElement('div');
            colBlock.className = 'column-block bg-slate-800 p-4 rounded-lg shadow-md text-center';
            colBlock.dataset.col = key;
            
            const values = data.map(row => row[key]).slice(0, 3); // Show first 3 values as example
            let valuesHtml = values.map(v => `<div class="font-fira text-xs truncate text-slate-300">${typeof v === 'number' ? v.toLocaleString() : v}</div>`).join('');
            if (data.length > 3) {
                 valuesHtml += '<div class="font-fira text-xs text-slate-500 mt-1">...</div>';
            }

            colBlock.innerHTML = `
                <h3 class="font-bold text-white">${colInfo.title}</h3>
                <div class="my-2"><span class="data-type ${colInfo.class}">${colInfo.type}</span></div>
                <div class="bg-slate-900/50 p-2 rounded-md space-y-1">${valuesHtml}</div>
            `;
            columnContainer.appendChild(colBlock);
        });

        // 3. Set up interactions
        function updateExplanation(key) {
            const explanation = explanations[key] || explanations.default;
            explanationPanel.innerHTML = `
                <h3 class="text-xl font-bold text-indigo-300 mb-2">${explanation.title}</h3>
                <p class="text-indigo-100">${explanation.text}</p>
            `;
             if (currentHighlight) {
                currentHighlight.classList.remove('highlight');
            }
            const newHighlight = document.querySelector(`[data-col="${key}"]`);
            if (newHighlight) {
                newHighlight.classList.add('highlight');
                currentHighlight = newHighlight;
            }
        }

        document.querySelector('.w-full').addEventListener('click', (e) => {
            if (e.target.matches('.table-header-custom')) {
                const colKey = e.target.dataset.col;
                updateExplanation(colKey);
            }
        });

        columnContainer.addEventListener('click', (e) => {
            const colBlock = e.target.closest('.column-block');
            if (colBlock) {
                const colKey = colBlock.dataset.col;
                updateExplanation(colKey);
            }
        });

        // Initial state
        updateExplanation('default');

    </script>
</body>
</html>
