<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Parquet Files: An Interactive Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .tab-active {
            background-color: #3b82f6;
            color: white;
        }
        .table-cell {
            transition: background-color 0.2s ease-in-out;
        }
        /* New style for the sequential CSV highlight */
        .cell-highlight {
            background-color: #bfdbfe !important;
        }
        
        /* Keep the column-based animation */
        .column-based .table-cell:nth-child(1) { animation: highlight-column 1.5s ease-in-out infinite alternate 0s; }
        .column-based .table-cell:nth-child(2) { animation: highlight-column 1.5s ease-in-out infinite alternate 0.5s; }
        .column-based .table-cell:nth-child(3) { animation: highlight-column 1.5s ease-in-out infinite alternate 1s; }

        @keyframes highlight-column {
            from { background-color: #d1fae5; }
            to { background-color: #a7f3d0; }
        }
        .benefit-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .benefit-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-5xl">

        <!-- Header -->
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-2">What is a Parquet File?</h1>
            <p class="text-lg text-gray-600">An interactive guide for beginners.</p>
        </header>

        <!-- Main Content -->
        <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg">

            <!-- Section 1: The Big Idea -->
            <section id="intro" class="mb-10">
                <h2 class="text-2xl font-bold text-blue-600 mb-4 border-l-4 border-blue-600 pl-4">The Big Idea: It's All About Organisation</h2>
                <p class="text-base leading-relaxed">
                    Imagine you have a huge spreadsheet of sales data. A <strong>CSV (Comma-Separated Values)</strong> file is like a simple text document where you write down each sale, one after another, row by row. It's easy to write, but to find all the sales from a specific region, you have to read the entire document from top to bottom.
                </p>
                <br>
                <p class="text-base leading-relaxed">
                    A <strong>Parquet file</strong> is like a super-organised filing cabinet. Instead of storing data row-by-row, it stores it <strong>column-by-column</strong>. All the 'Region' data is together, all the 'Sales Amount' data is together, and so on. This might seem like a small change, but it makes finding and analysing specific information incredibly fast.
                </p>
            </section>

            <!-- Section 2: Interactive Visualisation -->
            <section id="interactive-viz" class="mb-10">
                <h2 class="text-2xl font-bold text-blue-600 mb-4 border-l-4 border-blue-600 pl-4">Interactive: CSV vs. Parquet Storage</h2>
                <p class="text-base mb-6">Click the buttons to see how the same data is read by a computer in each format. Notice how CSV reads the full record, while Parquet can grab just the columns it needs.</p>

                <div class="flex justify-center mb-6">
                    <div class="inline-flex rounded-md shadow-sm" role="group">
                        <button id="switchToRow" type="button" class="py-2 px-4 text-sm font-medium rounded-l-lg border border-gray-200 tab-active">
                            CSV (Row-Based)
                        </button>
                        <button id="switchToColumn" type="button" class="py-2 px-4 text-sm font-medium rounded-r-md border border-gray-200">
                            Parquet (Column-Based)
                        </button>
                    </div>
                </div>

                <!-- Data Table -->
                <div id="dataTable" class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Product ID</th>
                                <th class="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Region</th>
                                <th class="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Sales ($)</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>
                <div class="mt-4 text-center">
                    <p id="explanationText" class="text-gray-600 italic">Reading data cell-by-cell, row-by-row. To get all 'Regions', the computer must read through every piece of data.</p>
                </div>
            </section>

            <!-- Section 3: Why Use Parquet? -->
            <section id="benefits">
                <h2 class="text-2xl font-bold text-blue-600 mb-6 border-l-4 border-blue-600 pl-4">The 3 Big Wins of Using Parquet</h2>
                <div class="grid md:grid-cols-3 gap-6">
                    <!-- Benefit 1: Faster Queries -->
                    <div class="benefit-card bg-gray-50 p-6 rounded-xl border border-gray-200">
                        <div class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 text-blue-600 mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                        </div>
                        <h3 class="text-lg font-semibold mb-2">1. Blasing Fast Queries âš¡</h3>
                        <p class="text-sm text-gray-600">Because data is grouped by column, you only read the data you need. If you want to calculate the average sales, you just read the 'Sales' column, ignoring all others. This is called "column pruning" and it's a huge time-saver.</p>
                    </div>
                    <!-- Benefit 2: Smaller Files -->
                    <div class="benefit-card bg-gray-50 p-6 rounded-xl border border-gray-200">
                        <div class="flex items-center justify-center h-12 w-12 rounded-full bg-green-100 text-green-600 mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 1v4m0 0h-4m4 0l-5-5" /></svg>
                        </div>
                        <h3 class="text-lg font-semibold mb-2">2. Amasing Compression ðŸ“¦</h3>
                        <p class="text-sm text-gray-600">Data in the same column is often very similar (e.g., a 'Region' column might only have "North", "South", "East", "West"). This similarity makes it extremely easy to compress, leading to much smaller file sizes than CSVs. This saves storage costs and speeds up data transfer.</p>
                    </div>
                    <!-- Benefit 3: Schema Evolution -->
                    <div class="benefit-card bg-gray-50 p-6 rounded-xl border border-gray-200">
                        <div class="flex items-center justify-center h-12 w-12 rounded-full bg-purple-100 text-purple-600 mb-4">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
                        </div>
                        <h3 class="text-lg font-semibold mb-2">3. Smart Data Types (No Guesswork!) ðŸ“Š</h3>
                        <p class="text-sm text-gray-600">Parquet knows what kind of data is in each column because it saves a "schema" (a blueprint). It knows 'Sales' are numbers and 'Region' is text. This prevents common CSV errors, like a zip code "07748" being accidentally read as the number 7748, losing the important leading zero.</p>
                    </div>
                </div>
            </section>

             <!-- Section 4: Summary Table -->
            <section id="summary">
                <h2 class="text-2xl font-bold text-blue-600 mb-4 border-l-4 border-blue-600 pl-4">At a Glance: CSV vs. Parquet</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-700">Feature</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-700">CSV</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-gray-700">Parquet</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="py-3 px-4 font-medium">Storage Format</td>
                                <td class="py-3 px-4">Row-based (Plain Text)</td>
                                <td class="py-3 px-4 font-semibold">Column-based (Binary)</td>
                            </tr>
                            <tr class="border-b bg-gray-50">
                                <td class="py-3 px-4 font-medium">Read Performance</td>
                                <td class="py-3 px-4">Slow for analytics (reads everything)</td>
                                <td class="py-3 px-4 font-semibold">Very Fast (reads only needed columns)</td>
                            </tr>
                            <tr class="border-b">
                                <td class="py-3 px-4 font-medium">File Size</td>
                                <td class="py-3 px-4">Large (uncompressed text)</td>
                                <td class="py-3 px-4 font-semibold">Small (highly compressed)</td>
                            </tr>
                            <tr class="bg-gray-50">
                                <td class="py-3 px-4 font-medium">Data Types</td>
                                <td class="py-3 px-4">Programs must guess the data type.</td>
                                <td class="py-3 px-4 font-semibold">Stores a schema, so types are known.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-8">
            <p class="text-sm text-gray-500">When to use what? Use CSV for simple data exchange or human-readable files. Use Parquet for serious data analysis and storage, especially with large datasets.</p>
        </footer>
    </div>

    <script>
        const data = [
            { id: 'P-101', region: 'North', sales: 1500 },
            { id: 'P-102', region: 'South', sales: 800 },
            { id: 'P-103', region: 'North', sales: 2200 },
            { id: 'P-104', region: 'West', sales: 1250 },
            { id: 'P-105', region: 'South', sales: 3100 },
        ];

        const tableBody = document.getElementById('tableBody');
        const dataTableDiv = document.getElementById('dataTable');
        const explanationText = document.getElementById('explanationText');
        const switchToRowBtn = document.getElementById('switchToRow');
        const switchToColumnBtn = document.getElementById('switchToColumn');

        // --- New animation logic for CSV ---
        let csvAnimationInterval = null;
        let currentRowIndex = 0;
        let currentCellIndex = 0;

        function stopCsvAnimation() {
            if (csvAnimationInterval) {
                clearInterval(csvAnimationInterval);
                csvAnimationInterval = null;
            }
            // Clear any lingering highlights
            document.querySelectorAll('#tableBody .table-cell').forEach(cell => {
                cell.classList.remove('cell-highlight');
            });
        }

        function startCsvAnimation() {
            stopCsvAnimation(); // Ensure only one animation runs
            const rows = document.querySelectorAll('#tableBody tr');
            if (rows.length === 0) return;
            
            const numRows = rows.length;
            const numCells = rows[0].querySelectorAll('td').length;

            csvAnimationInterval = setInterval(() => {
                // Remove previous highlight
                 document.querySelectorAll('#tableBody .table-cell').forEach(cell => {
                    cell.classList.remove('cell-highlight');
                });

                // Highlight the current cell
                const currentRow = rows[currentRowIndex];
                const currentCell = currentRow.querySelectorAll('td')[currentCellIndex];
                currentCell.classList.add('cell-highlight');

                // Move to the next cell or row
                currentCellIndex++;
                if (currentCellIndex >= numCells) {
                    currentCellIndex = 0;
                    currentRowIndex++;
                    if (currentRowIndex >= numRows) {
                        currentRowIndex = 0; // Loop back to the start
                    }
                }
            }, 400); // Adjust speed of highlight
        }
        // --- End of new animation logic ---

        function renderTable() {
            tableBody.innerHTML = '';
            data.forEach(item => {
                const row = document.createElement('tr');
                row.className = 'border-b';
                row.innerHTML = `
                    <td class="table-cell py-3 px-4">${item.id}</td>
                    <td class="table-cell py-3 px-4">${item.region}</td>
                    <td class="table-cell py-3 px-4">${item.sales}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        switchToRowBtn.addEventListener('click', () => {
            dataTableDiv.classList.remove('column-based');
            switchToRowBtn.classList.add('tab-active');
            switchToColumnBtn.classList.remove('tab-active');
            explanationText.textContent = "Reading data cell-by-cell, row-by-row. To get all 'Regions', the computer must read through every piece of data.";
            startCsvAnimation();
        });

        switchToColumnBtn.addEventListener('click', () => {
            stopCsvAnimation(); // Stop the CSV animation
            dataTableDiv.classList.add('column-based');
            switchToColumnBtn.classList.add('tab-active');
            switchToRowBtn.classList.remove('tab-active');
            explanationText.textContent = "Reading data column by column. To get all 'Regions', the computer reads just that one column, skipping the rest!";
        });

        // Initial render and start
        renderTable();
        startCsvAnimation(); // Start in CSV mode by default
    </script>

</body>
</html>
